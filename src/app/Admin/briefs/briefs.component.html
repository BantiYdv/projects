<div class="">
    <div class=" d-flex justify-content-center align-items-center">
        <div class="toggle_css">
            <button class="button_css" [ngClass]="{'button_light': !isOn, 'button_success': isOn}"
                (click)="toggleState(true)">
                Active
            </button>
            <button class="button_css" [ngClass]="{'button_light': isOn, 'button_success': !isOn}"
                (click)="toggleState(false)">
                Closed
            </button>
        </div>
    </div>
</div>
<div class="not_data_img_div" *ngIf="projectsActive.length == 0 && isOn">
    <p class="not-found-text">Data Not Found!</p>
    <img class="not-found-image" src="/assets/images/notFound.png" alt="Image Not Found">
</div>
<div class="table-responsive" *ngIf="isOn && projectsActive.length != 0 ">

    <table style="width:1300px; margin: 0 auto;">
        <tr>
            <th colspan="11">
                <div class="show_month">
                    <input type="month" style="background-color: transparent; border: none; outline: none; width: 25px;"
                        name="checkDataMonth" [(ngModel)]="checkDataMonth">{{ checkDataMonth | date:'MMMM yyyy' }}
                </div>
            </th>
        </tr>
        <tr>
            <td colspan="2" style="width: 300px;">
                <div class="menu_project_css">Projects</div>
            </td>
            <td style="width: 200px;">
                <div class="weeks_css css_01">1st Week</div>
            </td>
            <td style="width: 200px;">
                <div class="weeks_css css_02">2nd Week</div>
            </td>
            <td style="width: 200px;">
                <div class="weeks_css css_03">3rd Week</div>
            </td>
            <td style="width: 200px;">
                <div class="weeks_css css_04">4th Week</div>
            </td>
            <td style="width: 200px;">
                <div class="weeks_css css_05">5th Week</div>
            </td>
        </tr>
        <tr>
            <td style="width: 150px;">
                <div class="sub_css_text css_01">Projects</div>
            </td>
            <td style="width: 150px;">
                <div class="sub_css_text css_02">Tasks</div>
            </td>
            <td style="width: 200px;">
                <div class="sub_days_css_1">
                    <div class="days_css">1</div>
                    <div class="days_css">2</div>
                    <div class="days_css">3</div>
                    <div class="days_css">4</div>
                    <div class="days_css">5</div>
                    <div class="days_css">6</div>
                    <div class="days_css">7</div>
                </div>
            </td>
            <td style="width: 200px;">
                <div class="sub_days_css_1">
                    <div class="days_css">8</div>
                    <div class="days_css">9</div>
                    <div class="days_css">10</div>
                    <div class="days_css">11</div>
                    <div class="days_css">12</div>
                    <div class="days_css">13</div>
                    <div class="days_css">14</div>
                </div>
            </td>
            <td style="width: 200px;">
                <div class="sub_days_css_1">
                    <div class="days_css">15</div>
                    <div class="days_css">16</div>
                    <div class="days_css">17</div>
                    <div class="days_css">18</div>
                    <div class="days_css">19</div>
                    <div class="days_css">20</div>
                    <div class="days_css">21</div>
                </div>
            </td>
            <td style="width: 200px;">
                <div class="sub_days_css_1">
                    <div class="days_css">22</div>
                    <div class="days_css">23</div>
                    <div class="days_css">24</div>
                    <div class="days_css">25</div>
                    <div class="days_css">26</div>
                    <div class="days_css">27</div>
                    <div class="days_css">28</div>
                </div>
            </td>
            <td style="width: 200px;">
                <div class="sub_days_css_1">
                    <div class="days_css">29</div>
                    <div class="days_css">30</div>
                    <div class="days_css">31</div>
                </div>
            </td>
        </tr>
        <tr>
            <td style="width: 150px;">
                <div class="pro_tasks">
                    <div class="projects_data_css">
                        <div *ngFor="let pro of projectsActive" (click)="getTaskListOfActiveProject(pro._id)">
                            {{pro.name}}</div>
                    </div>
                </div>
            </td>
            <td style="width: 150px;">
                <div *ngIf="tasks.length == 0" style="height: 300px; text-align: center;">
                    <div class="">
                        <p class="not-found-text">Tasks Not Found!</p>
                    </div>
                </div>
                <div class="pro_tasks" *ngIf="tasks.length >= 1">
                    <div class="tasks_data_css">
                        <div *ngFor="let task of tasks">{{ task.name.length > 10 ? task.name.slice(0, 10) + '...' :
                            task.name }}</div>
                    </div>
                </div>
            </td>
            <td colspan="5" style="width: 1000px;">
                <div *ngIf="tasks.length == 0" style="height: 300px; text-align: center;">
                    <div class="">
                        <p class="not-found-text">Task Details Not Found!</p>
                    </div>
                </div>
                <div class="pro_tasks" *ngIf="tasks.length >= 1">
                    <div class="chart_css">
                        <div *ngFor="let task of tasks" class="bar" [title]="task.name">
                            <div class="d-flex justify-content-center align-items-center w-100">
                                <div
                                    *ngIf="!isSameMonthAndYear(checkDataMonth, task.deadlineDate) && !isSameMonthAndYear(checkDataMonth, task.completed) && !isSameMonthAndYear(checkDataMonth, task.start) && !isSameMonthAndYear(checkDataMonth, task.startDate) && !isSameMonthAndYear(checkDataMonth, task.created)">
                                    No tasks details for {{ checkDataMonth | date:'MMMM yyyy' }}
                                </div>
                            </div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.deadlineDate) && !isSameMonthAndYear(task.created, task.deadlineDate)"
                                class="progress text-white" style="background-color: rgb(233, 233, 233);"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.deadlineDate | date: 'dd-MM-yyyy')"
                                [style.width.%]="calculateMarginLeft(task.deadlineDate)"></div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.deadlineDate) && isSameMonthAndYear(task.created, task.deadlineDate)"
                                class="progress text-white" style="background-color: rgb(233, 233, 233);"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.deadlineDate | date: 'dd-MM-yyyy')"
                                [style.margin-left.%]="calculateMarginLeft(task.created)"
                                [style.width.%]="calculateWidth(task.deadlineDate,task.created)"></div>
                            <div *ngIf="!isSameMonthAndYear(checkDataMonth, task.deadlineDate) && !isSameMonthAndYear(task.created, task.deadlineDate)  && isCheckDataMonthPresent(task.created, task.deadlineDate)"
                                class="progress text-white" style="background-color: rgb(233, 233, 233);"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.deadlineDate | date: 'dd-MM-yyyy')"
                                [style.margin-left.%]="calculateMarginLeft(task.created)"
                                [style.width.%]="calculateWidth(task.deadlineDate,task.created)"></div>
                            <div *ngIf="isCheckDataMonthPresent(task.created, task.deadlineDate) && !isSameMonthAndYear(checkDataMonth, task.created) && !isSameMonthAndYear(checkDataMonth, task.deadlineDate)"
                                class="progress text-white" style="background-color: rgb(233, 233, 233);"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.deadlineDate | date: 'dd-MM-yyyy')"
                                [style.width.%]="calculateWidth(task.deadlineDate,task.created)"></div>




                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.completed) && !isSameMonthAndYear(task.start, task.completed)"
                                class="progress text-white" style="background-color: #cfda0a;"
                                [title]="task.start | date: 'dd-MM-yyyy' + ' to ' + (task.completed | date: 'dd-MM-yyyy')"
                                [style.width.%]="calculateMarginLeft(task.completed)"></div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.completed) && isSameMonthAndYear(task.start, task.completed)"
                                class="progress text-white" style="background-color: #cfda0a;"
                                [title]="task.start | date: 'dd-MM-yyyy' + ' to ' + (task.completed | date: 'dd-MM-yyyy')"
                                [style.margin-left.%]="calculateMarginLeft(task.start)"
                                [style.width.%]="calculateWidth(task.completed,task.start)"></div>
                            <div *ngIf="!isSameMonthAndYear(checkDataMonth, task.completed) && !isSameMonthAndYear(task.start, task.completed)  && isCheckDataMonthPresent(task.start, task.completed)"
                                class="progress text-white" style="background-color: #cfda0a;"
                                [title]="task.start | date: 'dd-MM-yyyy' + ' to ' + (task.completed | date: 'dd-MM-yyyy')"
                                [style.margin-left.%]="calculateMarginLeft(task.start)"
                                [style.width.%]="calculateWidth(task.completed,task.start)"></div>
                            <div *ngIf="isCheckDataMonthPresent(task.start, task.completed) == true && !isSameMonthAndYear(checkDataMonth, task.start) && !isSameMonthAndYear(checkDataMonth, task.completed)"
                                class="progress text-white" style="background-color: #cfda0a;"
                                [title]="task.start | date: 'dd-MM-yyyy' + ' to ' + (task.completed | date: 'dd-MM-yyyy')"
                                [style.width.%]="calculateWidth(task.completed,task.start)"></div>

                            <div 
                            *ngIf="checkMonthYears(formatDateObject(),task.start,task.completed) && checkMonthMonth2(formatDateObject()) &&  !isSameMonthAndYear(checkDataMonth, task.completed)"
                                class="progress text-white" style="background-color: #cfda0a;"
                                [title]="task.start | date: 'dd-MM-yyyy' + ' to ' + (task.completed | date: 'dd-MM-yyyy')"
                                [style.width.%]="calculateWidth(task.completed,task.start)"></div>
<!-- <button (click)="checkMonthYears(formatDateObject(),task.start,task.completed)">'button'</button>
<button (click)="checkMonthMonth2(formatDateObject())">'button'</button> -->



                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.start) && !isSameMonthAndYear(task.created, task.start)"
                                class="progress text-white" style="background-color: #fabcce;"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.start | date: 'dd-MM-yyyy')"
                                [style.width.%]="calculateMarginLeft(task.start)"></div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.start) && isSameMonthAndYear(task.created, task.start)"
                                class="progress text-white" style="background-color: #fabcce;"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.start | date: 'dd-MM-yyyy')"
                                [style.margin-left.%]="calculateMarginLeft(task.created)"
                                [style.width.%]="calculateWidth(task.start,task.created)"></div>
                            <div *ngIf="!isSameMonthAndYear(checkDataMonth, task.start) && !isSameMonthAndYear(task.created, task.start) && isCheckDataMonthPresent(task.created, task.start)"
                                class="progress text-white" style="background-color: #fabcce;"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.start | date: 'dd-MM-yyyy')"
                                [style.margin-left.%]="calculateMarginLeft(task.created)"
                                [style.width.%]="calculateWidth(task.start,task.created)"></div>
                            <div *ngIf="isCheckDataMonthPresent(task.created, task.start) && !isSameMonthAndYear(checkDataMonth, task.start) && !isSameMonthAndYear(checkDataMonth, task.created)"
                                class="progress text-white" style="background-color: #fabcce;"
                                [title]="task.created | date: 'dd-MM-yyyy' + ' to ' + (task.start | date: 'dd-MM-yyyy')"
                                [style.width.%]="calculateWidth(task.start,task.created)"></div>




                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.completed)" class="progress text-white"
                                style="background-color: #e55579; width: 2.87%;"
                                [title]="task.completed | date: 'dd-MM-yyyy'"
                                [style.margin-left.%]="calculateMarginLeft(task.completed)"></div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.start)" class="progress text-white"
                                style="background-color: #bcc600; width: 2.87%;"
                                [title]="task.start | date: 'dd-MM-yyyy'"
                                [style.margin-left.%]="calculateMarginLeft(task.start)"></div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.startDate)" class="progress text-white"
                                style="background-color: #6E86FF; width: 2.87%;"
                                [title]="task.startDate | date: 'dd-MM-yyyy'"
                                [style.margin-left.%]="calculateMarginLeft(task.startDate)"></div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.created)" class="progress text-white"
                                style="background-color: #eca6ba; width: 2.87%;"
                                [title]="task.created | date: 'dd-MM-yyyy'"
                                [style.margin-left.%]="calculateMarginLeft(task.created)"></div>
                            <div *ngIf="isSameMonthAndYear(checkDataMonth, task.deadlineDate)"
                                class="progress text-white" style="background-color: #c3607c; width: 2.87%;"
                                [title]="task.deadlineDate | date: 'dd-MM-yyyy'"
                                [style.margin-left.%]="calculateMarginLeft(task.deadlineDate)"></div>
                        </div>
                    </div>
                </div>
            </td>
        </tr>
    </table>
    <div class="d-flex justify-content-md-center align-items-md-center justify-content-sm-end align-items-sm-end">
        <div class="color_show_date">
            <div class="d-flex flex-nowrap">
                <div class="color_css bg_created"></div>
                <div class="color_name">Created</div>
            </div>
            <div class="d-flex flex-nowrap">
                <div class="color_css bg_startDate"></div>
                <div class="color_name">Start Date</div>
            </div>
            <div class="d-flex flex-nowrap">
                <div class="color_css bg_start"></div>
                <div class="color_name">Start</div>
            </div>
            <div class="d-flex flex-nowrap">
                <div class="color_css bg_completed"></div>
                <div class="color_name">Completed</div>
            </div>
            <div class="d-flex flex-nowrap">
                <div class="color_css bg_deadline"></div>
                <div class="color_name">Deadline</div>
            </div>
        </div>
        <!-- <div class="alert alert-primary alert-dismissible">
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            <strong>Primary!</strong> Indicates an important action.
          </div> -->
    </div>
</div>

<div *ngIf="!isOn">
    <div class="not_data_img_div" *ngIf="projectsFinised.length == 0">
        <p class="not-found-text">Data Not Found!</p>
        <img class="not-found-image" src="/assets/images/notFound.png" alt="Image Not Found">
    </div>

    <div class="table-responsive">

        <table style="width:1300px;  margin: 0 auto" *ngIf="projectsFinised.length > 0">
            <tr>
                <th style="width: 260px;">
                    <div class="project_date_css_2 project_css_2">
                        <div>Projects Name</div>
                    </div>
                </th>
                <th style="width: 260px;">
                    <div class="project_date_css_2 project_css_22">
                        <div>Producer Name</div>
                    </div>
                </th>
                <th style="width: 260px;">
                    <div class="project_date_css_2 project_css_22">
                        <div>Handled By</div>
                    </div>
                </th>
                <th style="width: 260px;">
                    <div class="project_date_css_2 project_css_22">
                        <div>Deadline Date</div>
                    </div>
                </th>
                <th style="width: 260px;">
                    <div class="project_date_css_2 project_css_23">
                        <div>Completed On</div>
                    </div>
                </th>
            </tr>
            <tr class="table_data" *ngFor="let pro of projectsFinised.slice(0, 3)">
                <td [title]="pro.name">
                    <div class="bg_bg_color">
                        <span>{{ pro.name.length > 8 ? (pro.name | slice:0:8) + '...' : pro.name }}</span>
                    </div>
                </td>
                <td>
                    <div class="box_css_bg_border">
                        <span class="sub_box_css_bg_border" [title]="pro.client_id.name">
                            <span class="sub_sub_box_css_bg_border">{{pro.client_id.name}}</span>
                        </span>

                    </div>
                </td>
                <td>
                    <div class="box_css_bg_border">
                        <span class="sub_box_css_bg_border" [title]="pro.handel_by.name">
                            <span class="sub_sub_box_css_bg_border">{{pro.handel_by.name}}</span>
                        </span>

                    </div>
                </td>
                <td>
                    <div class="box_css_bg_border">
                        <span class="sub_box_css_bg_border" [title]="pro.deadline">
                            <span class="sub_sub_box_css_bg_border">{{pro.deadline}}</span>
                        </span>

                    </div>
                </td>
                <td>
                    <div class="box_css_bg_border">
                        <span class="sub_box_css_bg_border">
                            <span class="sub_sub_box_css_bg_border">john amehnas</span>
                        </span>

                    </div>
                </td>
            </tr>
        </table>
    </div>
    <div class=" d-flex justify-content-center align-items-center" *ngIf="projectsFinised.length > 0">
        <div class="view_all_button" routerLink="/admin/history">View All&nbsp;<i class="fa fa-angle-down"></i></div>
    </div>

</div>